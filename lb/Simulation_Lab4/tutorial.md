# Імітаційне моделювання комп'ютерних систем
## Лабораторная работа №4. Моделирование в среде CoppeliaSim

<br>

### 4.1 Цель работы
Познакомиться с возможностями среды робототехнического моделирования CoppeliaSim. Использовать существующие модели и компоненты и корректировать логику их работы. Получить представление о синтаксисе языка Lua.

<br>

### 4.2 Описание лабораторной установки
Для выполнения лабораторной работы потребуется свободно распространяемая (для учебного использования) среда [**CoppeliaSim**](https://www.coppeliarobotics.com/downloads).  
Процесс выполнения данной лабораторной работы (в отличие от предыдущих), нет необходимости описывать в md-файле. Для отработки достаточно будет соответствующего **файла сцены** ("File" -> "Save scene as..." -> "CoppeliaSim scene...") и ответов на вопросы по ней.

<br>

### 4.3 Порядок выполнения работы
1. В новой сцене (открываемой CoppeliaSim при запуске) **добавить робота Pioneer P3DX** (найти можно в "Model browser" -> "robots" -> "mobile"). *Это уже знакомый с лекций робот, приводимый в движение двумя колесами, скорость вращения каждого из которых управляется сигналами с датчиков, что позволяет изменять направление движения при обнаружении поблизости препятствия.*  
Попрактиковаться в манипулировании сценой - запуск симуляции, перемещение объектов, вращение объектов в разных плоскостях, изменение угла обзора сцены и т.д. *Это пригодится при дальнейшей работе.*
2. Добавить на сцену в произвольное место перед роботом **препятствие**. Например, обычную стену: "Model browser" -> "infrastructure" -> "walls"). Проверить, как изменится направление движения робота.
3. Добавить на робота **камеру**, изображение с которой будет выводиться пользователю и показывать, что "видит" перед собою робот в процессе движения. Для этого необходимо добавить собственно камеру (следите, чтобы она была добавлена именно в состав робота в иерехии объектов сцены) и, по ПКМ по сцене, добавить Floating view (это отображаемый пользователю "экран"), в свойствах которого ассоциировать его с выбранной камерой. Проверить работу.
4. Добавить **трассировку** движения робота - чтобы он оставлял за собой "след". Удобно для этого воспользоваться кодом из роботов из готовых сцен в папке tutorials, идущей в комплекте с CoppeliaSim.
5. На основе сцены "LineFollowingBubbleRob" (с которой удобно брать элементы и код для своей сцены), реализовать перемещение робота Pioneer P3DX **по линии**. Для этого потребуется добавить датчики (с соответствующей логикой) и "трассу". *Обратите внимание на изменение трассы - буквальный "копипаст" будет плохой идеей, т.к. пионер может просто не вписаться по габаритам. Хотя, это можно подправить размещением датчиков... Кстати, в предлагаемом моём примере работы датчики размещены несколько некорректно - часть из них геометрически оказалась несколько впереди корпуса робота.*
<br>
<br>
Возможно **необязательное** усложнение задания, путём использования иных роботов, освоения других компонентов и логики их работы, неописанных возможностей CoppeliaSim (по своему интересу, простор для этого есть) **допустимо и поощряется** более высокими баллами за **отработку**.  
Обязательно **согласуйте**, что именно планируете реализовать из неучтённого порядком выполнения работы. Это позволит и определить, насколько стоит такое усложнение повышения оценки.  
В случае согласованного усложнения, данная "усложнённая" лабораторная работа может выполняться совместно **коллективом** до трёх и более (по согласованию) человек. Но помните, что вопросы на отработке будут ко всем участникам бригады.

### 4.4 Пример выполнения работы
Для ориентировки, что может получится в итоге, можно изучить [готовую сцену](example.ttt).

<br>

### 4.5 Содержание отчета
Наличие отчета не является необходимым. Его функции выполняет файл сцены, который должен будет быть выложен на сервисе GitHub и после получения отработки должна быть предоставлена ссылка на репозиторий.

<br>

<!-- 
Это пока заготовка с прошлой лабораторной, ближе к проведению, прикину вопросы и литературу.
### 4.5 Контрольные вопросы
1. Какие задачи выполняет иерархия объектов в COPPELIASIM?
1.	Каким образом можно открыть свойства отдельных объектов для редактирования?


<br>
-->
### СПИСОК ЛИТЕРАТУРЫ
1. Среда [CoppeliaSim](https://www.coppeliarobotics.com/).
1. [Репозиторий](https://github.com/CoppeliaRobotics) со сценами, моделями и т.д.
1. [CoppeliaSim User Manual](https://www.coppeliarobotics.com/helpFiles/index.html).
1. [Разбор](https://www.coppeliarobotics.com/helpFiles/en/lineFollowingBubbleRobTutorial.htm) готового примера робота, следующего по линии.
1. [Learn Lua in 15 Minutes](https://tylerneylon.com/a/learn-lua/).
1. [Руководство](https://lua.org.ru/contents_ru.html) по языку Lua.
1. [Описание процесса](https://habr.com/ru/post/648923/) добавления элементов интерфейса пользователя и рисования графиков.
1. Цикл видеоуроков [A Complete CoppeliaSim Tutorial (V-REP)](https://www.youtube.com/playlist?list=PLjzuoBhdtaXOoqkJUqhYQletLLnJP8vjZ).

<!-- 
Уроки по робототехнике: https://edurobots.org/2020/02/lua-coppeliasim/, https://edurobots.org/2020/02/coppeliasim/.
Идеи задач по робототехнике: https://robot-help.ru/lessons-2/lesson-11.html
Про Луа: https://ru.wikipedia.org/wiki/Lua
Магистерская работа, включающая использование CoppeliaSim: https://openarchive.nure.ua/server/api/core/bitstreams/d9fcecfb-18f6-4f61-972f-ef43bc550c40/content
О моделировании в робототехнике: http://www.controlengrussia.com/innovatsii/modelnometallicheskaya-obolochka/
Бжихатлов И.А. Моделирование робототехнических систем в программе V-REP. Учебно-Методическое пособие. – СПб: Университет ИТМО, 2018. – 59с. Скачано.
Методические рекомендации использования симулятора моделирования динамической среды CoppeliaSim. Скачано.
О Газибо, на будущее: https://gazebosim.org/docs/garden/tutorials
Альтернатива средам моделирования роботов: https://trikset.com/products/trik-studio
-->