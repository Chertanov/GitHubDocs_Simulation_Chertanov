# Імітаційне моделювання комп'ютерних систем
## Лабораторна робота №4. Моделювання у середовищі CoppeliaSim

<br>

### 4.1 Мета роботи
Ознайомитись із можливостями середовища робототехнічного моделювання CoppeliaSim. Використовувати існуючі моделі та компоненти, отримати навички корегування логіки їхньої роботи. Отримати уявлення про синтакс мови Lua.

<br>

### 4.2 Необхідні засоби
Для виконання лабораторної роботи знадобиться вільно розповсюджуване (для навчального використання) середовище [**CoppeliaSim**](https://www.coppeliarobotics.com/downloads).  
Процес виконання даної лабораторної роботи (на відміну від попередніх) немає необхідності описувати в md-файлі. Для відпрацювання достатньо буде відповідного **файлу сцени** ("File" -> "Save scene as..." -> "CoppeliaSim scene...") та відповідей на запитання щодо неї.

<br>

### 4.3 Порядок виконання роботи
1. У новій сцені (що відкривається при запуску CoppeliaSim) **додати робота Pioneer P3DX** (знайти можна в "Model browser" -> "robots" -> "mobile"). *Це вже знайомий з лекцій робот, що рухається двома колесами, швидкість обертання кожного з яких управляється сигналами з датчиків, що дозволяє змінювати напрямок руху при виявленні поблизу перешкоди.*  
Попрактикуватись у маніпулюванні сценою – запуск симуляції, переміщення об'єктів, обертання об'єктів у різних площинах, зміна кута огляду сцени тощо. *Це стане в нагоді при подальшій роботі.*
2. Додати на сцену у довільне місце перед роботом **перешкоду**. Наприклад, звичайну стіну: "Model browser" -> "infrastructure" -> "walls"). Перевірити, як зміниться напрямок руху робота.
3. Додати на робота **камеру**, зображення з якої виводитиметься користувачеві і буде показуватиме, що "бачить" перед собою робот у процесі руху. Для цього необхідно додати власне камеру (стежте, щоб вона була додана саме до складу робота в ієрхії об'єктів сцени) і, за ПКМ по сцені, додати Floating view (це "екран", що відображається користувачеві), у властивостях якого потрібно асоціювати його з обраною камерою. Перевірити роботу.
4. Додати **трасування** руху робота - щоб він залишав за собою "слід". Зручно для цього скористатися кодом із роботів з готових сцен у папці tutorials, що йде в комплекті з CoppeliaSim.
5. На основі сцени "LineFollowingBubbleRob" (з якої зручно брати елементи та код для своєї сцени), реалізувати переміщення робота Pioneer P3DX **по лінії**. Для цього потрібно додати датчики (з відповідною логікою) та "трасу". *Зверніть увагу на зміну траси - буквальний копіпаст буде поганою ідеєю, т.к. піонер може просто не вписатися за габаритами. Хоча, це можна підправити розміщенням датчиків... До речі, в моєму прикладі роботи датчики розміщені дещо некоректно - частина з них геометрично виявилася трохи попереду корпусу робота.*
<br>
<br>
Можливе ускладнення завдання шляхом використання інших роботів, опанування інших компонентів та логіки їх роботи, неописаних можливостей CoppeliaSim (за своїм інтересом, простір для цього є) - це **припустимо і заохочується** вищими балами за **відпрацювання**.  
Обов'язково **узгодьте**, що саме плануєте реалізувати з неврахованого порядком виконання роботи. Це дозволить і визначити, наскільки потребує таке ускладнення підвищення оцінки.  
У разі узгодженого ускладнення, ця "ускладнена" лабораторна робота може виконуватися спільно **колективом** до трьох і більше (за погодженням) осіб. Але пам'ятайте, що питання відпрацювання будуть до всіх учасників бригади.

### 4.4 Приклад виконання роботи
Для розуміння приблизного результату, є можливість розглянути [готову сцену](example.ttt).

<br>

### 4.5 Зміст звіту
Наявність звіту не є необхідною. Його функції виконує файл сцени, який має бути викладений на сервісі GitHub і після отримання відпрацювання має бути надане посилання на репозиторій.

<br>

<!-- 
Это пока заготовка с прошлой лабораторной, ближе к проведению, прикину вопросы и литературу.
### 4.5 Контрольные вопросы
1. Какие задачи выполняет иерархия объектов в COPPELIASIM?
1.	Каким образом можно открыть свойства отдельных объектов для редактирования?


<br>
-->
### Корисні посилання
1. Середовище [CoppeliaSim](https://www.coppeliarobotics.com/).
1. [Репозиторій](https://github.com/CoppeliaRobotics) зі сценами, моделями и т.і.
1. [CoppeliaSim User Manual](https://www.coppeliarobotics.com/helpFiles/index.html).
1. [Розгляд](https://www.coppeliarobotics.com/helpFiles/en/lineFollowingBubbleRobTutorial.htm) готового прикладу робота, що йде по лінії.
1. [Learn Lua in 15 Minutes](https://tylerneylon.com/a/learn-lua/).
1. [Посібник](https://lua.org.ru/contents_ru.html) по мові програмування Lua.
1. [Опис процесу](https://habr.com/ru/post/648923/) додавання елементів інтерфейсу користувача та малювання графіків.
1. Цикл відеоуроків [A Complete CoppeliaSim Tutorial (V-REP)](https://www.youtube.com/playlist?list=PLjzuoBhdtaXOoqkJUqhYQletLLnJP8vjZ).

<!-- 
Уроки по робототехнике: https://edurobots.org/2020/02/lua-coppeliasim/, https://edurobots.org/2020/02/coppeliasim/.
Идеи задач по робототехнике: https://robot-help.ru/lessons-2/lesson-11.html
Про Луа: https://ru.wikipedia.org/wiki/Lua
Магистерская работа, включающая использование CoppeliaSim: https://openarchive.nure.ua/server/api/core/bitstreams/d9fcecfb-18f6-4f61-972f-ef43bc550c40/content
О моделировании в робототехнике: http://www.controlengrussia.com/innovatsii/modelnometallicheskaya-obolochka/
Бжихатлов И.А. Моделирование робототехнических систем в программе V-REP. Учебно-Методическое пособие. – СПб: Университет ИТМО, 2018. – 59с. Скачано.
Методические рекомендации использования симулятора моделирования динамической среды CoppeliaSim. Скачано.
О Газибо, на будущее: https://gazebosim.org/docs/garden/tutorials
Альтернатива средам моделирования роботов: https://trikset.com/products/trik-studio
-->