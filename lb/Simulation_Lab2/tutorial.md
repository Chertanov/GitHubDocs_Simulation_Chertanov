# Імітаційне моделювання комп'ютерних систем
## Лабораторная работа №2. Редактирование имитационных моделей в среде NetLogo

<br>

### 2.1 Цель работы
Получить представление о синтаксисе и возможностях языка мультиагентного моделирования NetLogo.
Научиться вносить изменения в исходный код готовых моделей из разных предметных областей, предлагаемыми средой мультиагентного моделирования NetLogo.

<br>

### 2.2 Описание лабораторной установки
Для выполнения лабораторной работы потребуется:
- свободная среда мультиагентного моделирование **NetLogo**. Возможно использование в браузере **веб-версии** данного инструмента, но в случае внесения изменений в интерфейс управления моделированием потребуется работа с десктопной версией.
- для описания работы используется файл в формате **md**, размещаемый в составе репозитория лабораторной на сервисе GitHub. *Для удобства локальной работы с md-разметкой можно использовать редакторы кода, такие как MS Visual Studio Code или любой другой, знакомый пользователю. В случае локальной работы по подготовке md-файла, потребуется установленная СКВ Git.*
- для работы с веб-версией NetLogo и сервисом GitHub потребуется доступ к сети Internet.

<br>

### 2.3 Порядок выполнения работы
Помните, что реализация изменений не должна нарушать общую логику модели и приводить к её неадекватности объекту имитационного моделирования.  
При выборе модели для редактирования её логики доступны три пути **на свой выбор**:
1. Вносить коррективы в логику той модели, которую ранее выбирали, анализировали, описали и использовали в ходе выполнения лабораторной, посвященной [описанию имитационных моделей](..\Simulation_Lab1\tutorial.md). **Предполагаемые направления изменений логики обязательно согласуются** с преподавателем. Это необходимо для того, чтобы объём изменений был достаточен, но не чрезмерен.
2. Вносить коррективы в одну из моделей, **предложеных в списке в пункте 2.4**. Перечни необходимых и достаточных изменений указаны в вариантах, однако, данный путь предполагает необходимость **описания модели** (аналогично тому, как делали в лабораторной, посвященной [описанию имитационных моделей](..\Simulation_Lab1\tutorial.md). Воизбежание одновременного выбора одного и того же варианта большим числом студентов, чем это допустимо по условиям варианта, свой выбор **обязательно зафиксируйте** в [гугл-документе с общим доступом](https://docs.google.com/spreadsheets/d/1qpwpdv9j_9LmdFnWsEiEt_Qec-cPVk6LviXC2GWig-Y/edit).
3. Внесение **правок по своему выбору в модель по своему выбору**. Выбранная модель указывается в [гугл-документе с общим доступом](https://docs.google.com/spreadsheets/d/1qpwpdv9j_9LmdFnWsEiEt_Qec-cPVk6LviXC2GWig-Y/edit), правки **обязательно согласуются** с преподавателем. Этот путь также предполагает необходимость **описания модели** (аналогично тому, как делали в лабораторной, посвященной [описанию имитационных моделей](..\Simulation_Lab1\tutorial.md)).


*Дополнительный вариант пути выполнения лабораторной работы*. **Создание** (а не просто редактирование) и **описание** модели, **не опираясь на предлагаемые средой NetLogo**, а путём написания **собственной** программы (включая модель и визуализацию её использования) на одном из знакомых языковых средств. Однако, такой путь явно сложнее, поэтому предполагает как **согласование** с преподавателем, так и более высокую оценку за данную работу: вместо 12-18 баллов за эту лабораторную - или **30 баллов** (при условии использования браузерного JavaScript или C#/WinForms), или **25 баллов** (при использовании любых других средств программирования).

<br>

### 2.4 Варианты заданий
Этот пункт методических указаний имеет смысл **только при выборе пути №2** в пункте 2.3 порядка выполнения работы. В таблице перечислены предлагаемые модели и дано их неформальной описание, для общего представления. После таблицы - список вариантов, в которых описаны наборы необходимых изменений. Варианты индивидуальны, если не указано иного.

<table width="100%">
<caption>Общее описание предлагаемых моделей</caption>
    <thead>
        <tr>
            <th>Модель</th>
            <th>Неформальное описание</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>
                <a href="http://www.netlogoweb.org/launch#http://www.netlogoweb.org/assets/modelslib/Sample%20Models/Biology/Rabbits%20Grass%20Weeds.nlogo">Rabbits Grass Weeds</a>
            </td>
            <td>
                Модель лужайки с кроликами, которые пасутся на кормовой травке (и сорняках). Когда достаточно наелись - размножаются.
            </td>
        </tr>
        <tr>
            <td>
                <a href="http://www.netlogoweb.org/launch#http://www.netlogoweb.org/assets/modelslib/Sample%20Models/Biology/Evolution/Wolf%20Sheep%20Stride%20Inheritance.nlogo">Wolf Sheep Stride Inheritance</a>
            </td>
            <td>
                Простой вариант классической модели "хищник/жертва", в котором овцы поедают траву, волки поедают овец. Волки и овцы перемещаются по полю случайным образом, но каждый со своей скоростью, которая является наследуемым признаком.
            </td>
        </tr>
        <tr>
            <td>
                <a href="http://www.netlogoweb.org/launch#http://www.netlogoweb.org/assets/modelslib/Curricular%20Models/BEAGLE%20Evolution/Red%20Queen.nlogo">Red Queen</a>
            </td>
            <td>Модель совместной эволюции лягушек и змей. Змеи питаются лягушками, но лягушки ядовиты. Выживают те змеи, у которых достаточная сопротивляемость к яду съедаемой лягушки. Но и у лягушек яда может быть побольше. "Ядовитость" и "сопротивляемость к яду" являются наследуемыми признаками. <!-- Как они изменятся в популяции спустя некоторое время? И кто в итоге останется - змеи или гадюки?.. Жабы с гадюками - кто кого?.. --></td>
        </tr>
        <tr>
            <td></td>
            <td></td>
        </tr>
    </tbody>
</table>

На основе модели [Rabbits Grass Weeds](http://www.netlogoweb.org/launch#http://www.netlogoweb.org/assets/modelslib/Sample%20Models/Biology/Rabbits%20Grass%20Weeds.nlogo) доступны такие варианты:

**Rabbits-1**, вариант на 2 человек:
1. Добавление агентов-хищников, случайным образом перемещающихся по полю и поедающих кроликов при контакте с ними (если оказывается на той же клетке). Число хищников указывается пользователем через интерфейс среды моделирования.
1. Хищники имеют меру "сытости". Голодный умирает. Сытый охотится снова. Слишком наевшийся - стоит на месте. Значения для сытости и пресыщения задаётся пользователем. Сытость снижается по мере прохождения модельного времени. Скорость "перевариванивания" задаётся пользователем.
1. Кролики перемещаются случайным образом в некотором угле перед собой (как это реализовано изначально), но не в направлении хищника. Если в выбранном направлении движения есть хищник - ищется новое случайное направление, подальше от хищника. Если двигаться некуда - стоять на месте.
<!-- ВМЕСТО указания числа хищников пользователем при инициализации, возможна реализация направленного движения единственного хищника на поле: после "осмотра" в радиусе 5 клеток перемещение будет в том направлении, в котором найден кролик, либо в случайном, если добычи не обнаружено. -->
<!-- охота только в случае голода -->
<!-- расстановка хищников только в такое место, где он не будет съедать кого-то сразу. -->
<!-- возможность прыжков хищника по нескольку за один такт, в случайные места на лужайке -->

**Rabbits-2**, вариант на 2 человек: 
1. Убрать возможность находиться в одном участке одновременно более чем одному кролику.
2. Добавить вероятность отравиться при поедании сорняков. Заболевший кролик не может питаться, перемещаться и размножаться, помечается другим цветом и остаётся заболевшим 3 такта модельного времени.
3. Появление новых кроликов должно требовать не только сытости, но и здоровья, и присутствия в одной из соседних клеток другого сытого здорового кролика. Появление потомства происходит с вероятностью 50%.
1. Добавить на поле в случайном месте "ловушки". Число ловушек указывается пользователем. При попадании в "ловушку" кролик исчезает и инкрементируется счётчик пойманных кроликов, который отображается пользователю.

<!-- **Rabbits-3**:
1. Исправить ошибку с возможностью находиться в одном участке более чем одному кролику. -->

На основе модели [Wolf Sheep Stride Inheritance](http://www.netlogoweb.org/launch#http://www.netlogoweb.org/assets/modelslib/Sample%20Models/Biology/Evolution/Wolf%20Sheep%20Stride%20Inheritance.nlogo) доступны такие варианты:

**WolfSheep-1**:
1. Разграничить овец и волков на самцов и самок. Распределение при инициализации симуляции должно указываться пользователем. Скорректировать логику появления новых овец и волков - только вероятности и условия "сытости" явно недостаточно для адекватности модели.
1. Выводить пользователю данные о составе стада и стае, с отображением графиков изменения количества агентов.

**WolfSheep-2**:
1. Заменить волков - тиграми. Перед началом своего хода тигры "осматриваются", направление движения выбирается исходя из наличия овец и отсутствия других тигров. Если нет другой возможности - перемещается случайно. При нахождении на одном участке поля двух тигров, остаётся только один из них. <!-- Смотрят на заданное пользователем число клеток вперёд. -->
2. Овцы перемещаются случайным образом, но при обнаружении тигра на одной из клеток рядом, меняют направление на противоположное.
<!-- 3. Предусмотреть "безопасное пастбище" для овец - область поля, в которой овцы не могут быть съедены тиграми. Проверять при инициализации, чтобы там не оказывались тигры. -->

**WolfSheep-3**:  
1. Предусмотреть "загон" для овец. Это область, в которую (при наличии там свободных участков) могут попасть овцы, если случайно туда забредут. Волки изначально находятся вне загона, туда могут попасть только в ходе симуляции, с учётом указанной пользователем вероятности. Вести счётчик овец в загоне и выводить пользователю. Отображать график изменения числа овец в загоне.
1. Предусмотреть меру "сытости" для волков. Использовать указываемое пользователем процентное значение сытости, при котором волк не будет поедать овец.
<!-- // можно добавлять отключаемую взможность появляться только в загоне. -->

На основе модели [Red Queen](http://www.netlogoweb.org/launch#http://www.netlogoweb.org/assets/modelslib/Curricular%20Models/BEAGLE%20Evolution/Red%20Queen.nlogo) доступны такие варианты:

**FrogSnake-1**   
1. Ввести понятие "возраста" лягушек и змей. При инициализации использовать случайное значение. Максимальный возраст указывается пользователем, по достижению максимального возраста, особь погибает.
1. Увеличивать количество яда лягушек по мере их "взросления". Скорость роста количества яда задаётся пользователем. Увеличивать сопротивляемость змей к яду по мере её "взросления". Скорость роста сопротивляемости задаётся пользователем.
1. Разделить особей на самцов и самок. Для размножения необходимо находится на одном участке с другим представителем своего вида другого пола. Сопротивляемость и ядовитость наследуется от родителей наибольшая.

**FrogSnake-2** 
1. Увеличивать сопротивляемость змеи к яду при успешном поедании лягушки.
1. Уменьшать ядовитость лягушки после неудачной (для змеи) попытки её съесть. Ядовитость восстанавливается до исходной по мере смены тактов модельного времени.
1. После успешного съедания ядовитой лягушки, змея не двигается некоторое число тактов модельного времни, в зависимости от соотношения яда съеденной лягушки и своей сопротивляемости на момент поедания.

<!-- **FrogSnake-3**  
0. Перемещение змей и лягушек учитывает окружение. Лягушка првоеряет пространство вокруг себя и перемещается в направлении, противоположное обнаруженной змее, либо случайно вперёд, если змей не обнаружено. -->


### 2.5 Содержание отчета
Наличие отчета не является необходимым. Его функции выполняет **md-описание** работы (которое и так необходимо для отработки), подготовленное и выложеное на сервисе GitHub. Для ориентировки можно использовать [пример](example.md).
<br>

### 2.6 Контрольные вопросы
1. Какие подходы в рамках имитационного моделирования вам известны?
1. Виды агентов в среде NetLogo. *// дальше все вопросы - в контексте синтаксиса среды мультиагентного моделирования NetLogo.*
1. Как создать процедуру и функцию?
1. Как установить значение переменной?
1. Что такое turtles-own?
1. Для чего используется конструкция ask?
1. Как создать активных агентов? Какие их свойства изначально доступны?
1. Как создать разнородных активных агентов?
1. Для чего используется конструкция hatch?
1. Какие команды используются для перемещения агентов?
1. Как удалить агента с поля?
1. В чём разница между random-pxcor и random-xcor?
1. Как определить наличие агента в участке по курсу движения текущего агента?
1. Как получить случайное число в заданном диапазоне?
1. Как вывести пользователю текущее число активных агентов на поле?
1. Как происходит переход к следующему такту модельного времени?



<br>

### СПИСОК ЛИТЕРАТУРЫ
1. Среда моделирования [NetLogo](http://ccl.northwestern.edu/netlogo/).
1. [NetLogo Models Library](http://ccl.northwestern.edu/netlogo/models/index.cgi) - библиотека готовых имитационных моделей, полезно для ознакомления на тему "как можно сделать". Доступны как через десктопную версию, так и через NetLogo Web.
1. [NetLogo programming language in detail](http://ccl.northwestern.edu/netlogo/docs/programming.html#programming-guide)
1. [Beginner's Guide to NetLogo Programming](https://ccl.northwestern.edu/netlogo/bind/)
1. Руководства по разметке Markdown: [1](https://gist.github.com/Jekins/2bf2d0638163f1294637), [2](https://github.com/adam-p/markdown-here/wiki/Markdown-Cheatsheet), [3](https://www.markdownguide.org/basic-syntax/).
<!-- Литература по собственно моделированию здесь не нужна - вторая лаба сугубо прикладная, тут нужны указанные источники по NetLogo. И они указаны не зря! -->